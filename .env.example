# ============================================================================
# M.A.X. Backend - Configuration Template
# ============================================================================
# INSTRUCTIONS:
# 1. Copier ce fichier vers .env
# 2. Remplacer toutes les valeurs par vos vraies credentials
# 3. NE JAMAIS committer le fichier .env (déjà dans .gitignore)
# ============================================================================

# ——————————————————————————————————————————————————————————————————————————
# ANTHROPIC CLAUDE - API Configuration
# ——————————————————————————————————————————————————————————————————————————
# Clé API Anthropic (commence par sk-ant-)
# Obtenir sur: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-api03-VOTRE_CLE_ICI

# Modèle Claude à utiliser
# Options: claude-3-haiku-20240307, claude-3-5-sonnet-20241022, claude-3-opus-20240229
ANTHROPIC_MODEL=claude-3-haiku-20240307
AI_PROVIDER=anthropic
AI_MODEL=claude-3-haiku-20240307

# ——————————————————————————————————————————————————————————————————————————
# BUDGET & COÛTS IA
# ——————————————————————————————————————————————————————————————————————————
# Coût par million de tokens (USD)
COST_INPUT_PER_MILLION=0.25
COST_OUTPUT_PER_MILLION=1.25

# Budget total en tokens
TOKENS_BUDGET_TOTAL=1000000

# Autoriser réinitialisation du compteur (dev only)
ALLOW_RESET=true

# ——————————————————————————————————————————————————————————————————————————
# SERVEUR BACKEND
# ——————————————————————————————————————————————————————————————————————————
PORT=3005
ENABLE_SPEECH=true

# ——————————————————————————————————————————————————————————————————————————
# ESPOCRM - Configuration CRM
# ——————————————————————————————————————————————————————————————————————————
# URL de base EspoCRM (ajuster selon votre installation)
ESPO_BASE=http://127.0.0.1:8081/espocrm
ESPO_BASE_URL=http://127.0.0.1:8081/espocrm

# API Key EspoCRM (créer dans Admin > API Users)
# IMPORTANT: Créer un utilisateur dédié "MAX_BOT" avec permissions minimales
ESPO_API_KEY=VOTRE_ESPO_API_KEY_ICI

# Credentials admin (optionnel, pour opérations avancées)
# ATTENTION: Utiliser Basic Auth est risqué, préférer API Key
ESPO_ADMIN_API_KEY=VOTRE_ADMIN_API_KEY_ICI
ESPO_USERNAME=admin
ESPO_PASSWORD=VOTRE_MOT_DE_PASSE_ADMIN_ICI

# Configuration Docker/SSH pour phpExecutor
# Si max-backend tourne DANS Docker (production): détection automatique
# Ces variables sont optionnelles (fallback sur valeurs par défaut)
ESPO_CONTAINER_NAME=espocrm
ESPO_SSH_HOST=51.159.170.20
ESPO_SSH_USER=root

# ——————————————————————————————————————————————————————————————————————————
# M.A.X. - Configuration Assistant
# ——————————————————————————————————————————————————————————————————————————
MODE_DEFAULT=assist
MAX_BASE_URL=http://127.0.0.1:3005
MAX_TASK_STATUS_ENDPOINT=/api/tasks/:id/status

# ——————————————————————————————————————————————————————————————————————————
# N8N - Workflow Automation
# ——————————————————————————————————————————————————————————————————————————
N8N_BASE=http://127.0.0.1:5678
N8N_CALLBACK_SECRET=VOTRE_SECRET_N8N_ICI
N8N_WEBHOOK_URL=http://127.0.0.1:5678/webhook/max

# ——————————————————————————————————————————————————————————————————————————
# FRONTEND
# ——————————————————————————————————————————————————————————————————————————
VITE_API_BASE=http://127.0.0.1:3005

# ——————————————————————————————————————————————————————————————————————————
# MULTI-TENANT
# ——————————————————————————————————————————————————————————————————————————
ACTIVE_CLIENT=macrea

# ——————————————————————————————————————————————————————————————————————————
# JWT - Authentification
# ——————————————————————————————————————————————————————————————————————————
# Secret pour signer les tokens JWT (générer un string aléatoire long)
# Exemple: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=VOTRE_SECRET_JWT_ICI_64_CARACTERES_MINIMUM

# Durée de validité du token (en secondes)
JWT_EXPIRES_IN=86400

# ——————————————————————————————————————————————————————————————————————————
# SÉCURITÉ - Endpoint /api/tools/execute
# ——————————————————————————————————————————————————————————————————————————
# ATTENTION: Cet endpoint permet d'exécuter des tools directement sans passer par le LLM
# Activé uniquement pour les tests - DÉSACTIVÉ par défaut en production
ENABLE_TOOLS_EXECUTE=false

# Token admin pour protéger /api/tools/execute
# Générer un token aléatoire fort (ex: openssl rand -hex 32)
# Si défini, le header X-Admin-Token sera requis
ADMIN_TOKEN=

# ——————————————————————————————————————————————————————————————————————————
# WHATSAPP / TWILIO (optionnel)
# ——————————————————————————————————————————————————————————————————————————
# Twilio Account SID et Auth Token
# Obtenir sur: https://console.twilio.com/
TWILIO_ACCOUNT_SID=VOTRE_TWILIO_SID_ICI
TWILIO_AUTH_TOKEN=VOTRE_TWILIO_AUTH_TOKEN_ICI

# Numéro WhatsApp Twilio (format: whatsapp:+33...)
TWILIO_WHATSAPP_NUMBER=whatsapp:+33XXXXXXXXX

# URL publique du backend (pour webhooks Twilio)
# En dev: utiliser ngrok ou tunnel similaire
WEBHOOK_BASE_URL=https://VOTRE_DOMAINE_OU_NGROK.ngrok-free.app

# ——————————————————————————————————————————————————————————————————————————
# EMAIL - Configuration Provider
# ——————————————————————————————————————————————————————————————————————————
# Provider email: 'smtp' | 'mailjet' | 'sendgrid' | 'gmail'
EMAIL_PROVIDER=mailjet

# SMTP Direct (optionnel - bloqué sur Scaleway)
SMTP_HOST=ssl0.ovh.net
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=VOTRE_EMAIL@domaine.com
SMTP_PASSWORD=VOTRE_MOT_DE_PASSE_EMAIL
SMTP_FROM=contact@malalacrea.fr

# Mailjet API (recommandé - contourne blocage SMTP)
MAILJET_API_KEY=VOTRE_MAILJET_API_KEY
MAILJET_API_SECRET=VOTRE_MAILJET_API_SECRET
MAILJET_FROM_EMAIL=contact@malalacrea.fr
MAILJET_FROM_NAME=M.A.X. CRM

# ——————————————————————————————————————————————————————————————————————————
# SUPABASE (optionnel - pour Phase 2)
# ——————————————————————————————————————————————————————————————————————————
# SUPABASE_URL=https://VOTRE_PROJET.supabase.co
# SUPABASE_ANON_KEY=VOTRE_ANON_KEY_ICI
# SUPABASE_SERVICE_ROLE_KEY=VOTRE_SERVICE_ROLE_KEY_ICI

# ——————————————————————————————————————————————————————————————————————————
# OPENAI (optionnel - si switch depuis Anthropic)
# ——————————————————————————————————————————————————————————————————————————
# OPENAI_API_KEY=sk-VOTRE_CLE_OPENAI_ICI
# OPENAI_MODEL=gpt-4o-mini

# ——————————————————————————————————————————————————————————————————————————
# TÂCHES AUTOGEN (legacy - optionnel)
# ——————————————————————————————————————————————————————————————————————————
# TASKS_DIR=D:/Macrea/CRM/tasks_autogen
# TASK_REGISTRY_PATH=D:/Macrea/CRM/data/task_registry.json

# ——————————————————————————————————————————————————————————————————————————
# CRON - Tâches planifiées
# ——————————————————————————————————————————————————————————————————————————
# Clé secrète pour protéger les endpoints cron (sync all-tenants, etc.)
# Générer: node -e "console.log(require('crypto').randomBytes(16).toString('hex'))"
CRON_SECRET_KEY=VOTRE_CRON_SECRET_ICI

# ——————————————————————————————————————————————————————————————————————————
# DEBUG & LOGGING
# ——————————————————————————————————————————————————————————————————————————
# Niveau de log: error, warn, info, debug
LOG_LEVEL=info

# Activer logs détaillés
DEBUG=false